# 第三章 渐进记法

## 例题

**例 3-1** 因为
$$
\lim_{n\to\infty}\frac{10n+7}{3n^2+2n+6} = \lim_{n\to\infty}\frac{10/n+7/n^2}{3+2/n+6/n^2} = 0/3 = 0
$$
所以 $3n^2+2n+6$ 渐进地大于 $10n+7$，或者说 $10n+7$ 渐进地小于 $3n^2+2n+6$。

**例 3-2** 使用 “大 O” 记法描述例 3-1 的结果为：$10n+7=O(3n^2+2n+6)$；$10n^3-3=O(8n^4+9n^2)$；$12n+6=O(6n+2)$；$3n^2+2n+6 \neq O(n)$；$8n^4+9n^2\neq O(100n^3-3)$。

**例 3-3** 用习惯的 “大 O” 记法描述例 3-2 的结果是：$10n+7=O(n)$；$10n^3-3=O(n^3)$；$12n+6=O(n)$；$3n^2+2n+6 \neq O(n)$；$8n^4+9n^2\neq O(n^3)$。

**例 3-4** 在例 2-19 中，$t_{sum}(n) = 2n+3$。最大单位项是 $n$，因此 $t_{sum}(n) = O(n)$。

**例 3-5** 考虑 $f(m,n)=3m^2n+m^3+10mn+2n^2$。$10mn$ 渐进小于 $3m^2n$，因为
$$
\lim_{n\to\infty}\frac{10mn}{3m^2n}=\frac{10}{3m}\neq\infty 并且
\lim_{m\to\infty}\frac{10mn}{3m^2n}=\lim_{m\to\infty}\frac{10}{3m}=0
$$
在其余的项中，没有一个渐进小于另一个。去除 $10mn$，把剩余项的系数改为 1，我们得到 $f(m,n)=O(m^2n+m^3+n^2)$。

**例 3-6** $10n+7=\Omega(n)$ 因为 $10n+7$ 渐进等于 $n$；$10n^3-3=\Omega(n^3)$；$12n+6=\Omega(n)$；$3n^3+2n+6=\Omega(n)$；$8n^4+9n^2\neq\Omega(n^3)$；$3n^3+2n+6\neq\Omega(n^5)$；$8n^4+9n^2\neq\Omega(n^5)$。  
$10n+7=\Theta(n)$ 因为 $10n+7$ 渐进等于 $n$；$10n^3-3=\Theta(n^3)$；$12n+6=\Theta(n)$；$3n^3+2n+6\neq\Theta(n)$；$8n^4+9n^2\neq\Theta(n^3)$；$3n^3+2n+6\neq\Theta(n^5)$；$8n^4+9n^2\neq\Theta(n^5)$。

**定义 3-3【大 O 记法】** $f(n)=O(g(n))$，当且仅当存在常数 $c\gt0$ 和 $n_0$，使得对于所有的 $n\geq n_0$，有 $f(n)\leq cg(n)$。

**例 3-7【线性函数】** 考虑 $f(n)=3n+2$。当 $n\geq2$ 时，$3n+2\leq 3n+n\leq 4n$。因此 $f(n)=O(n)$，这时 $f(n)$ 的上限是一个线性函数。同样的结论还可以用其它方法得到。例如，对于 $n\gt0.25$，有 $3n+2\leq 10n$，这时 $c=10$，$n\gt 0.25$。而对 $n\geq 1$，有 $3n+2\leq 3n+2n \leq 5n$，这时 $c=5$，$n_0=1$。在大 O 定义中，$c$ 和 $n_0$ 只是用来说明 $f(n)$ 和 $g(n)$ 的关系，它们具体是什么值并不重要。

**例 3-8【平方函数】** 假定 $f(n)=10n^2+4n+2$。当 $n\geq 2$ 时，$f(n)\leq 10n^2+5n$。当 $n\geq 5$ 时，$5n\leq n^2$。于是当 $n\geq n_0=5$ 时，$f(n)\leq 10n^2+n^2=11n^2$，因此 $f(n)=O(n^2)$。
其实可以证明，当 $c\gt 10$，只要 $n\geq \frac{4+\sqrt{4+2(c-10)}}{c-10}$ 则有 $f(n)=19n^2+4n+2\leq cn^2$。

**例 3-9【指数函数】** 考虑 $f(n)=6*2^n+n^2$。对 $n\geq 4$，因为 $n^2\leq 2^n$ 所以有 $f(n)\leq 6*2^n+2^n=7*2^n$。因此 $f(n)=6*2^n+n^2=O(2^n)$。

**例 3-10【常量函数】** 对于常量函数 $f(n)$，比如 $f(n)=9$ 或者 $f(n)=2033$，可以记为 $f(n)=O(1)$。对于这种记法的正确性，很容易用大 O 定义来证明。

**例 3-11【松散界限】** 当 $n\geq 2$ 时，有 $3n+3\leq 3n^2$，因此 $3n+3=O(n^2)$。虽然 $n^2$ 是 $3n+3$ 的一个上限，但不是最小上限；可以用一个更小的函数（线性函数）作为上限，即 $3n+3=O(n)$。

**例 3-12【错误界限】** $3n+2\neq O(1)$，因为不存在 $c\gt 0$ 以及 $n_0$ 使得对于所有的 $n\geq n_0$，有 $3n+2\leq c$。可以用反证法严格证明这个结论。假定存在这样的 $c$ 以及 $n_0$，使得对于所有的 $n\geq n_0$ 有 $3n+2\leq c$，即 $n\leq (c-2)/3$，那么当 $n\gt max\{n_0, (c-2)/3\}$ 时，$3n+2\leq c$ 就不成立了。

**定理 3-1** 如果 $f(n)=a_mn^m+\cdots+a_1n+a_0$，且 $a_m>0$，那么 $f(n)=O(n^m)$
**证明**
$$f(n)\leq \sum_{i=0}^m|a_i|n^i \leq n^m\sum_{i=0}^m|a_i|n^{i-m} \leq n^m\sum_{i=0}^m|a_i|, n\geq 1$$
所以 $f(n)=O(n^m)$。

**例 3-13** 把定理 3-1 应用到例 3-7、例3-8 和例 3-10。例 3-7 的三个线性函数都有 $m=1$，因此它们均是 $O(n)$。例 3-8 的多项式都有 $m=2$，因此它们均为 $O(n^2)$。例 3-10 的两个常量函数都有 $m=0$，因此它们是 $O(1)$，即 $O(n^0)$。

**定理 3-2【大 O 比率定理】** 假设函数 $f(n)$ 和 $g(n)$ 有极限 $\lim_{n\to\infty}f(n)/g(n)$ 存在，那么关系式 $f(n)=O(g(n))$ 成立，当且仅当存在常数 $c$， 使得 $\lim_{n\to\infty}f(n)/g(n) \leq c$。

**例 3-14** 因为 $\lim_{n\to\infty}(3n+2)/n = 3$，所以 $3n+2=O(n)$。因为 $\lim_{n\to\infty}(10n^2+4n+2)/n^2 = 10$，所以 $10n^2+4n+2=O(n^2)$。由 $\lim_{n\to\infty}(6*2^n+n^2)/2^n = 6$，得知 $6*2^n+n^2=O(2^n)$ 成立。由 $\lim_{n\to\infty}(2n^2-3)/n^4 = 0$，得到 $2n^2-3=O(n^4)$。因为 $\lim_{n\to\infty}(3n^2+5)/n = \infty$，故 $3n^2+5\neq O(n)$。

**定义 3-4【$\Omega$记法】** $f(n)=\Omega(g(n))$ 当且仅当存在常数 $c>0$ 和 $n_0$，使得对所有的 $n\geq n_0$，有 $f(n)\geq cg(n)$。

**例 3-15** 对于所有的 $n$，有 $f(n)=3n+2 \geq 3n$，因此 $f(n)=\Omega(n)$。同样，由 $f(n)=3n+3>3n$，得知 $f(n)=\Omega(n)$。因 $f(n)=100n+6>100n$，所以 $100n+6=\Omega(n)$。因此 $3n+2$、$3n+3$ 和 $100n+6$ 都以线性函数为下限。

**定理 3-3** 如果 $f(n)=a_mn^m+ \cdots +a_1n + a_0$，且 $a_m>0$，则 $f(n)=\Omega(n^m)$。

**例 3-16** 由定理 3-3 可知，$3n+2=\Omega(n)$；$10n^2+4n+2=\Omega(n^2)$；$100n^4+3500n^2+82n+8=\Omega(n^4)$。

**定理 3-4【$\Omega$ 比率定理】** 假设函数 $f(n)$ 和 $g(n)$ 有极限 $\lim_{n\to\infty}g(n)/f(n)$ 存在，那么关系式 $f(n)=O(g(n))$ 成立，当且仅当存在常数 $c$， 使得 $\lim_{n\to\infty}g(n)/f(n) \leq c$。

**例 3-17** 因为 $\lim_{n\to\infty}n/(3n+2)=1/3$，所以 $3n+2=\Omega(n)$；因为 $\lim_{n\to\infty}n^2/(10n^2+4n+2)=1/10$，所以 $10n^2+4n+2=\Omega(n^2)$。因为 $\lim_{n\to\infty}2^n/(6*2^n+n^2)=1/6$，所以 $6*2^n+n^2=\Omega(2^n)$；因为 $\lim_{n\to\infty}n^3/(3n^2+5)=\infty$，所以 $3n^2+5\neq\Omega(n^3)$。

**定义 3-5【$\Theta$ 记法】** $f(n)=\Theta(g(n))$，当且仅当存在常数 $c_1 >0$，$c_2 > 0$ 和 $n_0$，使得对于所有的 $n\geq n_0$，有 $c_1g(n)\leq f(n) \leq c_2g(n)$。

**定理 3-5** 如果 $f(n)=a_mn^m+ \cdots +a_1n + a_0$，且 $a_m>0$，则 $f(n)=\Theta(n^m)$。

**定理 3-6【$\Theta 比率定理$】** 假设 $f(n)$ 和 $g(n)$ 有极限 $\lim_{n\to\infty}f(n)/g(n)$ 和 $\lim_{n\to\infty}g(n)/f(n)$ 存在，那么关系式 $f(n)=\Theta(g(n))$ 成立，当且仅当存在常数 $c$，使 $\lim_{n\to\infty}f(n)/g(n)\leq c$ 以及 $\lim_{n\to\infty}g(n)/f(n)\leq c$ 成立。

**定义 3-6【小 o 记法】** $f(n)=o(g(n))$，当且仅当 $f(n)=O(g(n))$ 且 $f(n)\neq\Omega(g(n))$。
